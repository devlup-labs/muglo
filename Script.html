<script>

// For getting all folders inside main folder and putting in dropdown box
    google.script.run.withSuccessHandler(yearbtn).Yearbtn();
    let LatestFolderId = ' ';
    function yearbtn(returnedArray_from_Yearbtn) {
        const [FolderName, FolderId] = returnedArray_from_Yearbtn;
        for (i = 0; i < FolderName.length; i++) {
            Folder = FolderName[i];
            $(".dropdown-menu").append("<p class ='dropdown-item'" + "id = '" + FolderId[i] + "' onclick = " + "FolderCounter('" + FolderId[i] + "')" + ">" + Folder + "</p>");
        };

        LatestFolderId = FolderId[0];
        FolderCounter(LatestFolderId);
        document.getElementById("year_btn").innerHTML = FolderName[0];

    };

    
// For getting info of folders of the dropdown item clicked from the Code.gs file
    function FolderCounter(FolderId) {
        $(".cards-holder").empty();
        $(".cards-holder").append("<div class='loading-parent text-center'><div class='loading'></div></div>");
        var name = document.getElementById(FolderId).innerHTML;
        document.getElementById("year_btn").innerHTML = name;
        google.script.run.withSuccessHandler(Show_Folders).CardsDisplay(FolderId);
    };

    
// Displaying all the folders of the dropdown item received by Cards Display function in Code.gs File
    function Show_Folders(returnedArray_from_CardsDisplay) {
        let [FolderName, FolderId] = returnedArray_from_CardsDisplay;
        for (i = 0; i < FolderName.length; i++) {
            Folder = FolderName[i];

            $(".cards-holder").append(
                "<a href='#header'>"
                + "<div class='book'" + "onclick =" + "doStuff('" + FolderId[i] + "')>"
                + "<ul>"
                + "<li class='page page3'></li>"
                + "<li class='page page2'></li>"
                + "<li class='page page1'></li>"
                + "<li class='cover'>"
                + "<div class='card-title'><h5>" + Folder + "</h5></div>"
                + "</li>"
                + "</ul>"
                + "</div>"
                + "</a>");

        };
        $(".loading-parent").remove();
    };
    
    
// for breadscrumb
    var Idarray = [];
    var Namearray = [];

    function updateBreadCrumb(arg) {
        if (Idarray.includes(arg[0])) {

            var ind = Idarray.indexOf(arg[0]);
            Idarray = Idarray.slice(0, ind + 1);
            Namearray = Namearray.slice(0, ind + 1);
            $("#list").empty();
            $("#list").append("<li onclick='gohome()' class='breadcrumb-item'>Home</li>");
            for (i = 0; i < Idarray.length; i++) {
                $("#list").append(
                    "<li onclick=" + "doStuff('" + Idarray[i] + "')  class='breadcrumb-item'>" + Namearray[i] + "</li>");
            }

        }
        else {

            Idarray.push(arg[0]);
            Namearray.push(arg[1]);
            $("#list").empty();
            $("#list").append("<li onclick='gohome()' class='breadcrumb-item'>Home</li>");
            for (i = 0; i < Idarray.length; i++) {
                $("#list").append(
                    "<li onclick=" + "doStuff('" + Idarray[i] + "')  class='breadcrumb-item'>" + Namearray[i] + "</li>");
            }

        }

        $("#list li").last().addClass("disabled");
        $("#list li").last().addClass("active");
        document.getElementById("event-after-home").innerHTML = Namearray[Namearray.length-1];

    }


// when someone clicks on the "Home" in breadscrumb
    function gohome() {
        $(".welcome-container").css("height", "100%");
        $("#Home").removeClass("hide");
        $("#Home").addClass("show");
        $("#header").addClass("header");
        $(".welcome").css("display", "flex");
        $("#nav-logo").css("width", "60px !important");
        $(".navbar-collapse").removeClass("nav-color");
        $(".navbar-nav").removeClass("nav-color");
        $(".navbar").removeClass("bg-colored");
        $("#Event").css("display", "none");
        $("#form").css("display", "block");
        $("#Albums").css("display", "block");
        $(".fetchedPage").remove();
        $(".FolderView").empty();
        $("#case-folders").empty();
        $(".loading-parent").remove();
        //FolderCounter(LatestFolderId);
        Idarray.length = 0;
        Namearray.length = 0;
        $("#list").empty();
        $("#list").append("<li onclick='gohome()' class='breadcrumb-item active'>Home</li>");
        $("#back_link").attr("href", "#Albums");
        document.getElementById("event-after-home").innerHTML = '';
        document.getElementById("searchInput1").value = '';
        document.getElementById("searchInput2").value = '';
    }
</script>
